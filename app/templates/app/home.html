{% extends "base.html" %}
{% load static %}

{% block title %}Trang chủ | LibraryHub{% endblock %}
{% block css %}{% static 'css/home.css' %}{% endblock %}

{% block content %}
    <main class="main-content">

    <section class="banner-slider">
    <div class="slides">

        <div class="slide active">
            <img src="{% static 'images/banner1.jpg' %}" alt="Banner 1">
            <div class="caption">
                <h2>Chào mừng đến LibraryHub</h2>
                <p>Kho tri thức mở dành cho mọi người</p>
            </div>
        </div>

        <div class="slide">
            <img src="{% static 'images/banner2.jpg' %}" alt="Banner 2">
            <div class="caption">
                <h2>Học tập mọi lúc</h2>
                <p>Truy cập tài nguyên mọi nơi</p>
            </div>
        </div>

        <div class="slide">
            <img src="{% static 'images/banner1.jpg' %}" alt="Banner 3">
            <div class="caption">
                <h2>Thư viện số</h2>
                <p>Hàng nghìn sách và tài liệu</p>
            </div>
        </div>
    </div>

    <!-- SEARCH OVER BANNER -->
    <div class="search-overlay">
        <form class="search-form" method="get" action="{% url 'search' %}">
    <input
        type="text"
        name="q"
        placeholder="Tìm sách, tác giả..."
    >
    <button type="submit">Tìm kiếm</button>
</form>
    </div>

</section>

    <!-- INTRO -->
<div class="home-container">

    <!-- INTRO SECTION (TRÁI) -->
    <div class="left-column">
    <div class="intro-section">
        <h1>Chào mừng đến với LibraryHub</h1>
        <p>
            Nơi quản lý và khám phá kho sách phong phú,  
            mượn – trả – đánh giá sách bằng AI.
        </p>

        <a href="{% url 'book_list' %}" class="btn-start">
    <i class="fa fa-book"></i>&nbsp; Khám phá sách
</a>

    </div>

    <div class="visit">
            <h4>Giờ mở cửa</h4>
            <ul>
                <li>Thứ 2 - 6: 08:00 - 20:00</li>
                <li>Thứ 7: 09:00 - 17:00</li>
                <li>CN: Đóng cửa</li>
            </ul>
        </div>
    </div>
    <!-- NEW SECTION (PHẢI) -->
    <div class="news-section">
    <h2>Tin tức</h2>

    <!-- GRID TIN TỨC -->
    <div class="news-grid" id="news-grid">
        <p>Đang tải tin tức...</p>
    </div>
    </div>

</div>


<!-- CATEGORIES -->
    <section class="categories-section">
        <h2>Danh mục tài nguyên</h2>

        <div class="categories-grid">
            <div class="category-card">
                <h3>Sách học tập</h3>
                <p>Giáo trình, sách tham khảo</p>
            </div>

            <div class="category-card">
                <h3>Tài liệu nghiên cứu</h3>
                <p>Luận văn, bài báo khoa học</p>
            </div>

            <div class="category-card">
                <h3>Công nghệ</h3>
                <p>Lập trình, AI, Data</p>
            </div>

            <div class="category-card">
                <h3>Kỹ năng & xã hội</h3>
                <p>Kỹ năng mềm, kinh tế</p>
            </div>
        </div>
    </section>

<!-- Tên danh mục chung -->
<section class="books-section">
    <h2>Sách mới</h2>
    <!-- <p class="book-category">Danh mục: Tất cả sách</p> -->

    <div class="new-books-grid">
        {% for book in new_books|slice:":4" %}
        <div class="book-card"
     data-id="{{ book.id }}"
     data-title="{{ book.title }}"
     data-image="{{ book.image_url }}"
     data-authors="{% for author in book.authors.all %}{{ author.name }}{% if not forloop.last %}, {% endif %}{% endfor %}"
     data-status="{% if book.quantity > 0 %}Có sẵn{% else %}Đã mượn{% endif %}"
     data-quantity="{{ book.quantity }}"
     data-description="{{ book.description|default:'Không có mô tả' }}">

            <img src="{{ book.image_url }}" alt="{{ book.title }}">
            <h4>{{ book.title }}</h4>
            <p class="author">
                {% for author in book.authors.all %}
                    {{ author.name }}{% if not forloop.last %}, {% endif %}
                {% empty %}
                    Không có tác giả
                {% endfor %}
            </p>
            <div class="book-meta">
                {% if book.quantity > 0 %}
                    <span class="status available">Có sẵn</span>
                {% else %}
                    <span class="status borrowed">Đã mượn</span>
                {% endif %}
            </div>
        </div>
        {% empty %}
        <p>Chưa có sách mới nào.</p>
        {% endfor %}
    </div>
</section>

<div class="book-modal" id="bookModal">
    <div class="modal-content">
        <span class="close-btn" id="closeModal">&times;</span>

        <div class="modal-body">
            <img id="modalImage" src="" alt="">

            <div class="modal-info">
                <h2 id="modalTitle"></h2>
                <p><strong>Tác giả:</strong> <span id="modalAuthors"></span></p>
                <p><strong>Trạng thái:</strong> <span id="modalStatus"></span></p>
                <p id="modalDescription"></p>

                <button id="borrowBtn" class="borrow-btn">Mượn sách</button>
            </div>
        </div>
    </div>
</div>

</main>
{% endblock %}
{% for book in books %}
<div class="book-card">
    <a href="{% url 'book_detail' book.id %}">
        <img src="{{ book.image.url }}">
        <h4>{{ book.title }}</h4>
    </a>
</div>
{% endfor %}


{% block javascript %}
<script src="{% static 'js/banner.js' %}"></script>
{% endblock %}

    
